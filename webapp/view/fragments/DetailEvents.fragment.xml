<core:FragmentDefinition
	xmlns="sap.m"
	xmlns:l="sap.ui.layout"
	xmlns:form="sap.ui.layout.form"
	xmlns:core="sap.ui.core">

	<Table 
		id="eventsTable"
		mode="{= (${status>/details_editable}) ? 'Delete' : 'None' }"
		items="{ path : 'events>' }"
		delete="onDeleteEventsTableRow">

		<columns>
			<Column
				hAlign="Begin"
				width="2.8em"
				popinDisplay="Inline"
				demandPopin="true">
				<Label text="{i18n>date}"/>
			</Column>
			<Column
				hAlign="Begin"
				width="4em"
				popinDisplay="Inline"
				demandPopin="true"
				minScreenWidth="Tablet">
				<Label text="Description"/>
			</Column>
			<Column
				hAlign="Begin"
				width="7em"
				popinDisplay="Inline"
				demandPopin="true"
				minScreenWidth="Tablet">
				<Label text="Observation"/>
			</Column>					
				<Column
				hAlign="Begin"
				width="7em"
				popinDisplay="Inline"
				demandPopin="true"
				minScreenWidth="Tablet">
				<Label text="Pot"/>
			</Column>		
				<Column
				hAlign="Begin"
				width="7em"
				popinDisplay="Inline"
				demandPopin="true"
				minScreenWidth="Tablet">
				<Label text="{i18n>soil}"/>
			</Column>
			
		</columns>
		
		<items>
			<ColumnListItem press="handleMeasurementPress">
				<cells>
					<!--date-->
					<ObjectIdentifier text="{path: 'events>date'}" />
					
					<!--general event notes-->
					<ObjectIdentifier text="{path: 'events>event_notes'}" />
					
					<!--observation segment-->
					<VBox>
						<VBox visible="{ path: 'events>observation/diseases',
									     formatter: '.formatter.existsAndNotEmpty'
										}">
							<Label text="Diseases" class="sapUiTinyMarginEnd"/>
							<Label
								design="Bold"
								text="{path: 'events>observation/diseases'}"
								wrapping="true"/>
						</VBox>
						<VBox visible="{ path: 'events>observation/height',
									     formatter: '.formatter.existsAndNotEmpty'
										}"
							 class="sapUiTinyMarginTop">
							<Label text="Height (in cm)" class="sapUiTinyMarginEnd"/>
							<Label
								design="Bold" 
								text="{path: 'events>observation/height'}"
								wrapping="true"/>
						</VBox>
						<VBox visible="{ path: 'events>observation/stem_max_diameter',
									     formatter: '.formatter.existsAndNotEmpty'
										}"
							 class="sapUiTinyMarginTop">
							<Label text="Diameter (max., in cm.)" class="sapUiTinyMarginEnd"/>
							<Label
								design="Bold" 
								text="{path: 'events>observation/stem_max_diameter'}"
								wrapping="true"/>
						</VBox>
						<VBox visible="{ path: 'events>observation/observation_notes',
									     formatter: '.formatter.existsAndNotEmpty'
										}"
							 class="sapUiTinyMarginTop">
							<Label text="Notes" class="sapUiTinyMarginEnd"/>
							<Label
								design="Bold" 
								text="{path: 'events>observation/observation_notes'}"
								wrapping="true"/>
						</VBox>
					</VBox>
					
					<!--pot segment-->
					<VBox>
						<VBox visible="{ path: 'events>pot_event_type',
									     formatter: '.formatter.existsAndNotEmpty'
										}">
								<Label design="Bold"
								text="{ path: 'events>pot_event_type' }" 
								wrapping="true"/>
						</VBox>
						<VBox visible="{ path: 'events>pot/material',
									     formatter: '.formatter.existsAndNotEmpty'
										}"
							class="sapUiTinyMarginTop">
							<Label text="Material" class="sapUiTinyMarginEnd"/>
							<Label
								design="Bold" 
								text="{path: 'events>pot/material'}"
								wrapping="true"/>
						</VBox>
						<VBox visible="{ path: 'events>pot/shape_top',
									     formatter: '.formatter.existsAndNotEmpty'
										}"
							 class="sapUiTinyMarginTop">
							<Label text="Shape (top)" class="sapUiTinyMarginEnd"/>
							<Label
								design="Bold" 
								text="{path: 'events>pot/shape_top'}"
								wrapping="true"/>
						</VBox>
						<VBox visible="{ path: 'events>pot/shape_side',
									     formatter: '.formatter.existsAndNotEmpty'
										}"
							 class="sapUiTinyMarginTop">
							<Label text="Shape (Side)" class="sapUiTinyMarginEnd"/>
							<Label
								design="Bold" text="{path: 'events>pot/shape_side'}"
								wrapping="true"/>
						</VBox>
						<VBox visible="{ path: 'events>pot/diameter_width',
									     formatter: '.formatter.existsAndNotEmpty'
										}"
							 class="sapUiTinyMarginTop">
							<Label text="Diameter/Width (in cm)" class="sapUiTinyMarginTop"/>
							<Label
								design="Bold" text="{path: 'events>pot/diameter_width'}"
								wrapping="true"/>
						</VBox>
					</VBox>
					
					<!--soil segment-->
					<VBox>
						<VBox visible="{ path: 'events>soil_event_type',
									     formatter: '.formatter.existsAndNotEmpty'
										}">
								<Label design="Bold"
								text="{ path: 'events>soil_event_type' }" 
								wrapping="true"/>
						</VBox>
						<VBox visible="{ path: 'events>soil/soil_name',
									     formatter: '.formatter.existsAndNotEmpty'
										}"
							class="sapUiTinyMarginTop">
							<Label text="Soil"/>
							<Label
								design="Bold"
								text="{path: 'events>soil/soil_name'}"
								wrapping="true"/>
						</VBox>
						<!--soil components list-->
						<VBox visible="{ path: 'events>soil/components',
									     formatter: '.formatter.existsAndNotEmpty'
										}"
							class="sapUiTinyMarginTop">
							<Label text="Components"/>
							<VBox items="{
								path: 'events>soil/components',
								templateShareable: 'false'
								}">
								<HBox>
									<Label
										design="Bold" 
										width="1.2em"
										text="{path: 'events>portion'}"
										wrapping="true"
										class="sapUiTinyMarginEnd"/>
									<Label
										design="Bold" 
										text="{path: 'events>component_name'}"
										wrapping="true"/>
								</HBox>
							</VBox>
						</VBox>
					</VBox>					
					
				</cells>
			</ColumnListItem>
			
		</items>
		
	</Table>	
	
</core:FragmentDefinition>
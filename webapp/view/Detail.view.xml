<m:View 
	displayBlock="true" 
	controllerName="plants.tagger.ui.controller.Detail" 
	height="100%"
	xmlns="sap.uxap"
	xmlns:m="sap.m"
	xmlns:f="sap.f"
	xmlns:core="sap.ui.core"
	xmlns:form="sap.ui.layout.form"
	xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
	class="sapUiSizeCompact">


	<ObjectPageLayout id="ObjectPageLayout"
		showTitleInHeaderContent="true"
		alwaysShowContentHeader="false"
		preserveHeaderStateOnScroll="false"
		headerContentPinnable="true"
		isChildPage="true"
		upperCaseAnchorBar="false">
		
		<headerTitle>
			<ObjectPageDynamicHeaderTitle>
				<expandedHeading>
					<m:Title 
						text="{plants>plant_name}" 
						wrapping="true" 
						class="sapUiSmallMarginEnd"/>
				</expandedHeading>

				<snappedHeading>
					<m:FlexBox wrap="Wrap" fitContainer="true" alignItems="Center">
						<m:FlexBox wrap="NoWrap" fitContainer="true" alignItems="Center" class="sapUiTinyMarginEnd">
							<f:Avatar 
								src="../../../../../../../{products>ProductPicUrl}" 
								displaySize="S" 
								displayShape="Square"/>
						<m:Title 
							text="{plants>plant_name}" 
							wrapping="true" 
							class="sapUiTinyMarginEnd sapUiSmallMarginBegin"/>
						
						</m:FlexBox>
					</m:FlexBox>
				</snappedHeading>

				<!--<navigationActions>-->
				<!--	<m:OverflowToolbarButton -->
				<!--		type="Transparent" -->
				<!--		icon="sap-icon://full-screen" -->
				<!--		press="handleFullScreen" -->
				<!--		tooltip="Enter Full Screen Mode" -->
				<!--		visible="{= ${/actionButtonsInfo/midColumn/fullScreen} !== null }"/>-->
				<!--	<m:OverflowToolbarButton -->
				<!--		type="Transparent" -->
				<!--		icon="sap-icon://exit-full-screen" -->
				<!--		press="handleExitFullScreen" -->
				<!--		tooltip="Exit Full Screen Mode" -->
				<!--		visible="{= ${/actionButtonsInfo/midColumn/exitFullScreen} !== null }"/>-->
				<!--	<m:OverflowToolbarButton -->
				<!--		type="Transparent"-->
				<!--		icon="sap-icon://decline" -->
				<!--		press="handleClose"  -->
				<!--		tooltip="Close column" -->
				<!--		visible="{= ${/actionButtonsInfo/midColumn/closeColumn} !== null }"/>-->
				<!--</navigationActions>-->

				<actions>
					<m:OverflowToolbarButton
						icon="sap-icon://edit"
						id="buttonEdit"
						text="Edit"
						tooltip="Toggle edit mode"
						press="onToggleEditMode"
						type="Transparent"/>
					<m:OverflowToolbarButton
						icon="sap-icon://delete"
						text="Delete"
						tooltip="Delete plant"
						press="onPressButtonDeletePlant"
						type="Transparent"/>
					<m:OverflowToolbarButton
						icon="sap-icon://blank-tag-2"
						text="Untagged"
						tooltip="Display untagged images"
						type="Transparent"
						press="onShowUntagged"/>
					
					<!--<core:Icon-->
					<!--	src="sap-icon://vertical-grip"/>-->
					<!--<m:ToolbarSpacer width="5rem"/>-->
					
					<m:OverflowToolbarButton 
						type="Transparent" 
						icon="sap-icon://full-screen" 
						press="handleFullScreen" 
						tooltip="Enter Full Screen Mode" 
						visible="{= ${/actionButtonsInfo/midColumn/fullScreen} !== null }"/>
					<m:OverflowToolbarButton 
						type="Transparent" 
						icon="sap-icon://exit-full-screen" 
						press="handleExitFullScreen" 
						tooltip="Exit Full Screen Mode" 
						visible="{= ${/actionButtonsInfo/midColumn/exitFullScreen} !== null }"/>
					<m:OverflowToolbarButton 
						type="Transparent"
						icon="sap-icon://decline" 
						press="handleClose"  
						tooltip="Close column" 
						visible="{= ${/actionButtonsInfo/midColumn/closeColumn} !== null }"/>
				</actions>

			</ObjectPageDynamicHeaderTitle>
		</headerTitle>

		<headerContent>
			<m:FlexBox wrap="Wrap" fitContainer="true" alignItems="Stretch">
				<f:Avatar 
					src="{plants>url_preview}"
					  displaySize="L"
					  displayShape="Square"
					  class="sapUiTinyMarginEnd">
				</f:Avatar>
				<m:VBox justifyContent="Center" class="sapUiSmallMarginEnd">
					<m:Label text="Spezies"/>
					<m:Text text="{plants>species}"/>
				</m:VBox>
				<m:VBox justifyContent="Center" class="sapUiSmallMarginEnd">
					<m:Label text="Beschreibung"/>
					<m:Text text="{plants>botany/description}"/>
				</m:VBox>
			</m:FlexBox>
			
		</headerContent>

		<sections>
			<ObjectPageSection 
				title="Allgemein"
				id="objPageSection">
				<subSections>
					<ObjectPageSubSection
						id="objPageSubSection">
						<blocks>
							
							<!--content inserted via fragment in controller-->
							
						</blocks>
					</ObjectPageSubSection>
				</subSections>
			</ObjectPageSection>
			
			
			
			
			<ObjectPageSection title="Botanica">
				<subSections>
					<ObjectPageSubSection>
						<blocks>	
			
							<m:VBox >
								<m:Label text="Subgenus (Untergattung)"/>
								<m:Text text="{plants>botany/subgenus}"/>
							</m:VBox>
							<m:VBox  >
								<m:Label text="Genus (Gattung)"/>
								<m:Text text="{plants>botany/genus}"/>
							</m:VBox>
							<m:VBox  >
								<m:Label text="Subfamilia (Unterfamilie)"/>
								<m:Text text="{plants>botany/subfamilia}"/>
							</m:VBox>
							<m:VBox  >
								<m:Label text="Familia (Familie)"/>
								<m:Text text="{plants>botany/familia}"/>
							</m:VBox>
							<m:VBox >
								<m:Label text="Ordo (Ordnung)"/>
								<m:Text text="{plants>botany/ordo}"/>
							</m:VBox>
							<m:VBox >
								<m:Label text="Subclassis (Unterklasse)"/>
								<m:Text text="{plants>botany/subclassis}"/>
							</m:VBox>
							<m:VBox>
								<m:Label text="Classis (Klasse)"/>
								<m:Text text="{plants>botany/classis}"/>
							</m:VBox>
							<m:VBox>
								<m:Label text="Divisio (Abteilung)"/>
								<m:Text text="{plants>botany/divisio}"/>
							</m:VBox>
							<m:VBox >
								<m:Label text="Superdivisio (Ãœberabteilung)"/>
								<m:Text text="{plants>botany/superdivisio}"/>
							</m:VBox>
							<m:VBox>
								<m:Label text="Subregnum (Unterreich)"/>
								<m:Text text="{plants>botany/subregnum}"/>
							</m:VBox>

						</blocks>
					</ObjectPageSubSection>
				</subSections>
			</ObjectPageSection>


			<ObjectPageSection title="Images">
				<subSections>
					<ObjectPageSubSection>
						<blocks>
							
							<m:List
								updateStarted="onListImagesUpdateStarted"
					        	id="listImages"
						        class="uoMImgGrid"
						        showSeparators="Inner"
						        growing="false"
						        growingThreshold="10"
						        growingScrollToLoad="false"
						        items="{
									path: 'images>/ImagesCollection',
									templateShareable:true,
									sorter: {
										path: 'record_date_time',
										descending: true
										}
									}">
								
						        <m:CustomListItem>
						          <m:HBox>
							          <m:Image 
							        	densityAware="false" 
							        	src="{images>url_small}">
							        	
							        	<m:detailBox>
											<m:LightBox>
												<m:LightBoxItem imageSrc="{images>url_original}"
																alt="{plants>plant_name}"
																title="{plants>plant_name} ({images>record_date_time})"
																subtitle="{images>description}">
												</m:LightBoxItem>
											</m:LightBox>
										</m:detailBox>
										
										<!-- Fixes Hbox layout on Android Stock Browser for Android 5.0 -->
										<m:layoutData>
											<m:FlexItemData growFactor="1" shrinkFactor="0"/>
										</m:layoutData>
										
									</m:Image>
									
										<core:Icon src="sap-icon://favorite"
											       size="1rem"
											       color="#E69A17" 
											       activeColor="blue"
											       press="onIconPressSetPreview">
											<core:layoutData>
												<m:FlexItemData growFactor="1" />
											</core:layoutData>
										</core:Icon>
									
							            <m:VBox class="productInfo" width="100%" alignItems="Stretch">
								            
								            <m:VBox justifyContent="Center" class="sapUiMediumMarginEnd">
									            <m:Label
									            	text='Description'/>
									            <m:TextArea 
									              class="productShortDescription" 
									              rows="3"
									              cols="45"
									              value="{images>description}" 
									              textAlign="Left"/>  
								            </m:VBox>
		
											<m:HBox>
												<m:Label
													text='Record date'/>
												<!--from 2015-01-25T13:22:10 to 2015-01-25 13:22-->
									            <m:Text 
									              class="sapUiSmallMarginBegin"
									              text="{= ${images>record_date_time}.substr(0,10) + ' ' + ${images>record_date_time}.substr(11,5) }" 
									              textAlign="Left" 
									              wrapping="false" />
									        </m:HBox>
									        
									        <!--<m:HBox>-->
									        <m:FlexBox alignItems="Start" 
									        		   direction="Column"
									        		   displayInline="false" 
									        		   fitContainer="false" >	
									        	
									        	<m:HBox>
										        	<m:Label
										        		text="Plants"/>
										        		
										        		<!--width="100%"-->
										        		<!--size="2em" -->
									        			<!--scrollWidth="50px"-->
									        		<m:Tokenizer 
									        			class="sapUiSizeCompact"
									        			id="tokenizerPlants"
									        			tokenChange="onTokenizerTokenChange"
									        			app:type="plant"
														tokens="{
															path: 'images>plants', templateShareable: false,
															sorter: { path: 'text' }
														}">
									        			
														<m:Token
															key="{images>key}" 
															text="{images>text}"
															tooltip="{images>text}"
															selected="{
																parts: [
																	{path:'images>key'},
																	{path:'plants>plant_name'}],
																formatter: '.formatter.tokenFormat'
															 }"
															 press="onPressImagePlantToken"
															 />
															
													</m:Tokenizer>
												</m:HBox>
												<!--templateShareable="true"-->
												<m:Input
													id="inputImageNewPlantName"
													submit="onInputImageNewPlantNameSubmit"
													visible="true"
													value=""
													editable="true"
													enabled="true"
													textAlign="Begin"
													type="Text"
													placeholder="Add Plants"
													showSuggestion="true"
													showTableSuggestionValueHelp="false"
													width="20rem"
													suggestionRows="{
														path: 'plants>/PlantsCollection', templateShareable: false
														}">
													
													<m:suggestionColumns>
														<m:Column
															hAlign="Begin"
															popinDisplay="Inline"
															demandPopin="true">
															<m:Label text="Name"/>
														</m:Column>
														<m:Column
															hAlign="End"
															popinDisplay="Inline"
															demandPopin="true"
															minScreenWidth="Tablet">
															<m:Label text="Species"/>
														</m:Column>
													</m:suggestionColumns>
													
													<m:suggestionRows>
														<m:ColumnListItem>
															<m:cells>
																<m:Label text="{plants>plant_name}"/>
																<m:Label text="{plants>species}"/>
															</m:cells>
														</m:ColumnListItem>
													</m:suggestionRows>
												</m:Input>
											<!--</m:HBox>-->
											</m:FlexBox>
													
											
											<m:FlexBox alignItems="Start" 
									        		   direction="Column"
									        		   displayInline="false" 
									        		   fitContainer="false" >			
											
												<m:HBox>
													<m:Label
										        		text="Keywords"/>
										        		
									        		<m:Tokenizer 
									        			class="sapUiSizeCompact"
									        			width="100%"
									        			tokenChange="onTokenizerTokenChange"
									        			app:type="keyword"
														tokens="{
															path: 'images>keywords', templateShareable: false,
															sorter: { path: 'text' }
														}">
														<m:Token
															key="{images>key}" 
															text="{images>text}"
															tooltip="{images>text}"/>
													</m:Tokenizer>
													
												</m:HBox>
													
													<m:Input
														width="18.5rem"
														id="inputImageNewKeyword"
														submit="onInputImageNewKeywordSubmit"
														visible="true"
														value=""
														editable="true"
														enabled="true"
														textAlign="Begin"
														type="Text"
														placeholder="Add Keywords"
														showSuggestion="false"/>
	
							        		</m:FlexBox>

							        		</m:VBox>
							          
							           </m:HBox>
							        </m:CustomListItem>
							      </m:List>
									
								</blocks>
							</ObjectPageSubSection>
						</subSections>
					</ObjectPageSection>

					
					<ObjectPageSection title="Events &amp; Measurements">
						<subSections>
							<ObjectPageSubSection>
								<blocks>
									<m:Table 
										id="measurementsTable"
										items="{ path : 'plants>measurements' }"
										itemPress="handleMeasurementPress">

										<m:columns>
											<m:Column
												hAlign="Begin"
												popinDisplay="Inline"
												demandPopin="true">
												<m:Label text="Date"/>
											</m:Column>
											<m:Column
												hAlign="Center"
												popinDisplay="Inline"
												demandPopin="true"
												minScreenWidth="Tablet">
												<m:Label text="Repot req. (0..5)"/>
											</m:Column>
											<m:Column
												hAlign="Center"
												popinDisplay="Inline"
												demandPopin="true"
												minScreenWidth="Tablet">
												<m:Label text="Measurement"/>
											</m:Column>					
												<m:Column
												hAlign="Center"
												popinDisplay="Inline"
												demandPopin="true"
												minScreenWidth="Tablet">
												<m:Label text="Pot"/>
											</m:Column>		
												<m:Column
												hAlign="Center"
												popinDisplay="Inline"
												demandPopin="true"
												minScreenWidth="Tablet">
												<m:Label text="Soil"/>
											</m:Column>		
											<m:Column
												hAlign="End"
												popinDisplay="Inline"
												demandPopin="true">
												<m:Label text="Notes"/>
											</m:Column>
											
										</m:columns>
										
										<m:items>
											<m:ColumnListItem press="handleMeasurementPress">
												<m:cells>
													<m:ObjectIdentifier text="{path: 'plants>measurement_date'}" />
													<m:ObjectIdentifier text="{path: 'plants>repot_rating'}" />
													<m:ObjectIdentifier text="{
																				parts: [
																						{path: 'plants>stem_max_diameter'},
																						{path: 'plants>stem_outset_diameter'},
																						{path: 'plants>height'}
																						],
																				formatter: '.formatter.formatMeasurement'
																				}" />
													
													<m:ObjectIdentifier text="{
																				parts: [
																						{path: 'plants>pot_width_above'},
																						{path: 'plants>pot_circular'},
																						{path: 'plants>pot_height'},
																						{path: 'plants>pot_material'}
																					],
																			    formatter: '.formatter.formatPot'
																			    }" />
													<m:ObjectIdentifier text="{path: 'plants>soil'}" />
													<m:ObjectIdentifier text="{path: 'plants>notes'}" />
												</m:cells>
											</m:ColumnListItem>
											

											

														<!--selected="{-->
														<!--	parts: [-->
														<!--		{path:'images>key'},-->
														<!--		{path:'plants>plant_name'}],-->
														<!--	formatter: '.formatter.tokenFormat'-->
														<!-- }"-->

											<!--<m:ColumnListItem press="handleMeasurementPress">-->
											<!--	<m:cells>-->
											<!--		<m:Label text="{plants>measurement_date}"/>-->
											<!--		<m:Label text="{plants>repot_rating}"/>-->
											<!--		<m:Label text="{plants>plant_name}"/>-->
											<!--		<m:Label text="{plants>pot_width_above}"/>-->
											<!--	</m:cells>-->
											<!--</m:ColumnListItem>-->
										</m:items>
										
									</m:Table>
								</blocks>
							</ObjectPageSubSection>
							<ObjectPageSubSection>
									<m:Button
										id="buttonAddMeasurement"
										text="Add"
										type="Emphasized"
										press="openDialogAddMeasurement"/>
							</ObjectPageSubSection>
						</subSections>
					</ObjectPageSection>
					
				<!--</subSections>-->
			<!--</ObjectPageSection>-->
			
		</sections>
	</ObjectPageLayout>
</m:View>
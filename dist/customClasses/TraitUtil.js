sap.ui.define(["sap/ui/base/Object","sap/m/MessageToast","sap/ui/model/FilterType","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(t,e,i,a,r){"use strict";var n;var o=t.extend("plants.tagger.ui.customClasses.TraitUtil",{constructor:function(){},onEditTraitPressRemoveTrait:function(t){this.applyToFragment("dialogEditTrait",t=>{var e=t.getBindingContext("taxon").getPath();var i=e.substr(0,e.indexOf("/traits/"));var a=t.getModel("taxon");var r=a.getProperty(i);var n=t.getBindingContext("taxon").getObject();var o=r.traits.indexOf(n);r.traits.splice(o,1);a.updateBindings();t.close()})},onBtnChangeTraitType:function(t,e){var i=this._oEditTraitFragment.getBindingContext("taxon").getObject();i.status=t;this.applyToFragment("dialogEditTrait",t=>{t.getModel("taxon").updateBindings();t.close()})},onPressTrait:function(t){var e=t.getSource();var i=e.getBindingContext("taxon").getPath();this.applyToFragment("dialogEditTrait",t=>{t.bindElement({path:i,model:"taxon"});t.openBy(e)})},onPressAddTrait:function(t){var i=this.byId("newTraitCategory").getSelectedKey();var a=this.byId("newTraitCategory")._getSelectedItemText();var r=this.byId("newTraitTrait").getValue().trim();var n=this.byId("newTraitStatus").getSelectedKey();if(r.length===0){e.show("Enter trait first.");return}var o=this.getView().getBindingContext("taxon").getObject();if(o.trait_categories){var s=o.trait_categories.find(function(t){return t.id.toString()===i});if(s){var g=s.traits.find(function(t){return t.trait===r});if(g){e.show("Trait already assigned.");return}}}if(!o.trait_categories){o.trait_categories=[]}if(!s){s={id:i,category_name:a};o.trait_categories.push(s)}var d={id:undefined,status:n,trait:r};if(s.traits){s.traits.push(d)}else{s.traits=[d]}this.getView().getBindingContext("taxon").getModel().updateBindings()},onLiveChangeNewTraitTrait:function(t){var e=t.getSource();var i=e.getBinding("suggestionItems").aApplicationFilters;var a=this.byId("newTraitCategory").getSelectedKey();if(i.length===0&&!!a){this.TraitUtil._filterNewTraitInputPropopsalsByTraitCategory(a)}},onChangeNewTraitCategory:function(t){var e=t.getParameter("selectedItem");var i=e.getProperty("key");this.TraitUtil._filterNewTraitInputPropopsalsByTraitCategory(i)},_filterNewTraitInputPropopsalsByTraitCategory:function(t){var e=[new a({path:"trait_category_id",operator:r.EQ,value1:t})];var n=this.getView().byId("newTraitTrait").getBinding("suggestionItems");n.filter(e,i.Application)}});return{getInstance:function(){if(!n){n=new o(this)}return n}}});
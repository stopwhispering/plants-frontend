sap.ui.define(["sap/ui/core/UIComponent","plants/tagger/ui/model/models","sap/ui/model/json/JSONModel","sap/f/FlexibleColumnLayoutSemanticHelper","plants/tagger/ui/model/ModelsHelper","plants/tagger/ui/customClasses/MessageUtil","plants/tagger/ui/customClasses/Util"],function(e,t,s,a,i,o,n){"use strict";return e.extend("plants.tagger.ui.Component",{metadata:{manifest:"json"},init:function(){e.prototype.init.apply(this,arguments);this.setModel(t.createDeviceModel(),"device");this.imagesRegistry={};this.imagesRegistryClone={};this.imagesPlantsLoaded=new Set;this.imagesUntaggedLoaded=false;o.getInstance.apply(this);var a=new s;a.setSizeLimit(2e3);this.setModel(a,"plants");var n=new s;n.setSizeLimit(5e4);this.setModel(n,"images");var r=new s;r.setSizeLimit(250);this.setModel(r,"untaggedImages");var l=new s;l.setSizeLimit(2e3);this.setModel(l,"taxon");var g=new s;l.setSizeLimit(2e3);this.setModel(g,"keywords");this.setModel(new s,"filterValues");var d=new s;d.setProperty("/PlantsEventsDict",{});this.setModel(d,"events");var m=new s;m.setProperty("/propertiesPlants",{});this.setModel(m,"properties");var u=new s;u.setProperty("/propertiesTaxon",{});this.setModel(u,"propertiesTaxa");var p=i.getInstance(this);p.reloadPlantsFromBackend();p.reloadTaxaFromBackend();p.reloadKeywordProposalsFromBackend();p.reloadTraitCategoryProposalsFromBackend();p.reloadNurserySourceProposalsFromBackend();p.reloadPropertyNamesFromBackend();this.oEventsDataClone={};this.oPropertiesDataClone={};var h=new s({preview_image:"favourite_image"});this.setModel(h,"status");this.setModel(new s);this.getRouter().initialize();this.requestUntaggedImages()},requestUntaggedImages:function(){$.ajax({url:n.getServiceUrl("images/untagged/"),context:this,async:true}).done(this._onReceivingUntaggedImages).fail(i.getInstance().onReceiveErrorGeneric.bind(this,"Plant Untagged Images (GET)"))},_onReceivingUntaggedImages:function(e,t,s){this.addPhotosToRegistry(e.ImagesCollection);this.resetUntaggedPhotos();this.imagesUntaggedLoaded=true},addPhotosToRegistry:function(e){e.forEach(e=>{if(!(e.path_original in this.imagesRegistry)){this.imagesRegistry[e.path_original]=e;this.imagesRegistryClone[e.path_original]=n.getClonedObject(e)}})},resetUntaggedPhotos:function(){var e=Object.entries(this.imagesRegistry).filter(e=>!e[1].plants.length);var e=e.map(e=>e[1]);this.getModel("untaggedImages").setProperty("/ImagesCollection",e)},createContent:function(){return sap.ui.view({viewName:"plants.tagger.ui.view.FlexibleColumnLayout",type:"XML"})},getHelper:function(){var e=this.getRootControl().byId("idFlexibleColumnLayout"),t=jQuery.sap.getUriParameters(),s={defaultTwoColumnLayoutType:sap.f.LayoutType.TwoColumnsMidExpanded,defaultThreeColumnLayoutType:sap.f.LayoutType.ThreeColumnsMidExpanded,mode:t.get("mode"),initialColumnsCount:t.get("initial"),maxColumnsCount:t.get("max")};return a.getInstanceFor(e,s)}})});
sap.ui.define(["plants/tagger/ui/customClasses/BaseController","sap/ui/model/Filter","sap/m/MessageBox","plants/tagger/ui/model/formatter","plants/tagger/ui/customClasses/ImageUtil","plants/tagger/ui/model/ModelsHelper","plants/tagger/ui/customClasses/Util","sap/m/MessageToast"],function(e,t,n,s,a,o,i,l){"use strict";return e.extend("plants.tagger.ui.controller.Untagged",{formatter:s,ImageUtil:a.getInstance(),ModelsHelper:o,onInit:function(){this._oRouter=this.getOwnerComponent().getRouter();this._oLayoutModel=this.getOwnerComponent().getModel();this._oRouter.getRoute("untagged").attachPatternMatched(this._onPatternMatched,this);this._currentPlantId=null;this.getOwnerComponent().getModel("status").setProperty("/untagged_selectable",false)},_onPatternMatched:function(e){this._currentPlantId=parseInt(e.getParameter("arguments").plant_id||this.plant_id||"0");if(e.getParameter("name")!=="untagged"){return}},handleClose:function(){var e=this._oLayoutModel.getProperty("/actionButtonsInfo/endColumn/closeColumn");this._oRouter.navTo("detail",{layout:e,plant_id:this._currentPlantId})},onPressReApplyUntaggedFilter:function(){this.getOwnerComponent().resetUntaggedPhotos()},onToggleSelectManyListMode:function(e){var t=e.getSource().getType();if(t==="Transparent"){e.getSource().setType("Emphasized");this.byId("listImagesUntagged").setMode("MultiSelect");this.getView().getModel("status").setProperty("/untagged_selectable",true)}else{e.getSource().setType("Transparent");this.byId("listImagesUntagged").setMode("None");this.getView().getModel("status").setProperty("/untagged_selectable",false)}},onSelectNone:function(e){this._resetSelection(this.byId("listImagesUntagged"))},_resetSelection:function(e){e.getItems().forEach(function(e){var t=e.setSelected(false)})},onSelectAll:function(e){this.byId("listImagesUntagged").getItems().forEach(function(e){var t=e.setSelected(true)})},onDeleteSelected:function(e){var t=this.byId("listImagesUntagged").getSelectedItems();if(t.length==0){l.show("Nothing selected.");return}var s=!!this.getView().$().closest(".sapUiSizeCompact").length;n.confirm("Delete "+t.length+" images?",{icon:n.Icon.WARNING,title:"Delete",stretch:false,onClose:this._confirmDeleteSelectedImages.bind(this,t),actions:["Delete","Cancel"],styleClass:s?"sapUiSizeCompact":""})},_confirmDeleteSelectedImages:function(e,t){if(t!=="Delete"){return}var n=e.map(e=>e.getBindingContext("untaggedImages").getObject());$.ajax({url:i.getServiceUrl("images/"),type:"DELETE",contentType:"application/json",data:JSON.stringify({images:n}),context:this}).done(function(e,t,s){this._onAjaxDeletedImagesSuccess(e,t,s,n,this.onSelectNone.apply(this))}).fail(o.getInstance().onReceiveErrorGeneric.bind(this,"Images (DELETE)"))}})},true);